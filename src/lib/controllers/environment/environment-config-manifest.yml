# Copyright 2019 Balena Ltd.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
---
properties:
- katapultEnvironment:
    type: object
    properties:
    - version:
        description: Set Version
        type: string
        default:
          eval: '"v1.0.0"'
    - productRepo:
        type: string
    - archiveStore:
        type: string
    - encryptionKeyPath:
        type: string
    - deployTarget:
        type: object
        properties:
        - type:
            description: Select the type of deploy-target
            type: string
            enum:
              - kubernetes
              - compose
        - endpoint:
            when: type == "kubernetes"
            description: Hostname of the kubernetes endpoint
            type: hostname
        - namespace:
            when: type == "kubernetes"
            description: Namespace of secrets in the of the kubernetes endpoint
            type: string
        - kubeConfigPath:
            when: type == "kubernetes"
            description: KubeConfig Path location (you may leave blank and use KUBECONFIG envvar instead)
            type: string
        - socket:
            when: type == "compose"
            description: Docker socket location
            type: string
        - bastion:
            type: object?
            description: Is your kubernetes endpoint accessible behind a bastion host? (Typically No)
            when: type == "kubernetes"
            properties:
            - host:
                description: Bastion host name
                type: hostname
            - port:
                description: Bastion port
                type: number
            - localPort:
                description: Local port for tunneling kubernetes API via the bastion
                type: number
            - username:
                description: Username for bastion ssh access
                type: string
            - key:
                description: Private key path for bastion ssh access (You may leave this blank and use BASTION_KEY_PATH environment variable instead)
                type?: path
