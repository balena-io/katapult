version: '3'
services:
  admin:
    image: 'resin/resin-admin:v1.18.3'
    ports:
      - '443:80'
    cap_add:
      - SYS_RESOURCE
      - SYS_ADMIN
    environment:
      API_HOST: '{{{environment.API_HOST}}}'
      UI_HOST: '{{{environment.UI_HOST}}}'
      PRODUCTION: '{{{environment.PRODUCTION}}}'
      CONFD_BACKEND: '{{{environment.CONFD_BACKEND}}}'
      LOGENTRIES_TOKEN: '{{{environment.SECRET_LOGENTRIES_TOKEN}}}'
      MAPS_API_KEY: '{{{environment.SECRET_MAPS_API_KEY}}}'
  registry:
    image: 'resin/resin-registry:v1.7.2'
    ports:
      - '443:80'
    cap_add:
      - SYS_RESOURCE
      - SYS_ADMIN
    volumes:
      - 'registry-data:/data'
    environment:
      CONFD_BACKEND: '{{{environment.CONFD_BACKEND}}}'
      REGISTRY_HOST: '{{{environment.REGISTRY_HOST}}}'
      REGISTRY_S3_BUCKET: '{{{environment.REGISTRY_S3_BUCKET}}}'
      REGISTRY_STORAGE_PATH: '{{{environment.REGISTRY_STORAGE_PATH}}}'
      LOGENTRIES_TOKEN: '{{{environment.SECRET_LOGENTRIES_TOKEN}}}'
      REGISTRY_S3_KEY: '{{{environment.SECRET_REGISTRY_S3_KEY}}}'
      REGISTRY_S3_SECRET: '{{{environment.SECRET_REGISTRY_S3_SECRET}}}'
      REGISTRY_TOKEN: '{{{environment.SECRET_REGISTRY_TOKEN}}}'
